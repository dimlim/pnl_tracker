# Price Chart Fix - –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—É —Ü—ñ–Ω

## –ü—Ä–æ–±–ª–µ–º–∞
–ù–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ `/dashboard/markets/ethereum` –≥—Ä–∞—Ñ—ñ–∫ –ø–æ–∫–∞–∑—É–≤–∞–≤:
- ‚ùå –í—Å—ñ –¥–∞—Ç–∏ —è–∫ "Oct 14" (–æ–¥–Ω–∞ –π —Ç–∞ —Å–∞–º–∞ –¥–∞—Ç–∞)
- ‚ùå –ì—Ä–∞—Ñ—ñ–∫ –≤–∏–≥–ª—è–¥–∞—î —è–∫ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞ –ª—ñ–Ω—ñ—è
- ‚ùå –ù–µ–º–æ–∂–ª–∏–≤–æ –ø–æ–±–∞—á–∏—Ç–∏ –∑–º—ñ–Ω–∏ —Ü—ñ–Ω –∑–∞ –ø–µ—Ä—ñ–æ–¥

## –í–∏–ø—Ä–∞–≤–ª–µ–Ω–Ω—è

### 1. –î–∏–Ω–∞–º—ñ—á–Ω–µ —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è –¥–∞—Ç –Ω–∞ –æ—Å—ñ X
**–§–∞–π–ª:** `apps/web/src/components/charts/price-chart-with-transactions.tsx`

–î–æ–¥–∞–Ω–æ –ª–æ–≥—ñ–∫—É, —è–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–±–∏—Ä–∞—î —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –ø–µ—Ä—ñ–æ–¥—É:
- **< 1 –¥–Ω—è**: `HH:mm` (–≥–æ–¥–∏–Ω–∏:—Ö–≤–∏–ª–∏–Ω–∏)
- **< 7 –¥–Ω—ñ–≤**: `MMM d HH:mm` (–º—ñ—Å—è—Ü—å –¥–µ–Ω—å —á–∞—Å)
- **< 90 –¥–Ω—ñ–≤**: `MMM d` (–º—ñ—Å—è—Ü—å –¥–µ–Ω—å)
- **> 90 –¥–Ω—ñ–≤**: `MMM yyyy` (–º—ñ—Å—è—Ü—å —Ä—ñ–∫)

### 2. –î–µ—Ç–∞–ª—å–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è
–î–æ–¥–∞–Ω–æ –ª–æ–≥–∏ –¥–ª—è –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏:
- –î—ñ–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–∏—Ö (–ø–µ—Ä—à–∞, —Å–µ—Ä–µ–¥–Ω—è, –æ—Å—Ç–∞–Ω–Ω—è —Ç–æ—á–∫–∞)
- Timestamp –≤ ISO —Ñ–æ—Ä–º–∞—Ç –¥–ª—è –ª–µ–≥–∫–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –¥—ñ–∞–ø–∞–∑–æ–Ω—É –≤ –¥–Ω—è—Ö

## –Ø–∫ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏

### –ö—Ä–æ–∫ 1: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞
–í—ñ–¥–∫—Ä–∏–π—Ç–µ DevTools (F12) ‚Üí Console —ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏:

```
üìä Price Data Range: {
  first: { timestamp: ..., date: "2024-10-07T...", price: ... },
  middle: { timestamp: ..., date: "2024-10-10T...", price: ... },
  last: { timestamp: ..., date: "2024-10-14T...", price: ... },
  rangeInDays: 7
}
```

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏:**
- ‚úÖ `rangeInDays` –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –≤–∏–±—Ä–∞–Ω–æ–º—É –ø–µ—Ä—ñ–æ–¥—É (7 –¥–ª—è "7D", 30 –¥–ª—è "1M", —Ç–æ—â–æ)
- ‚úÖ –î–∞—Ç–∏ `first` —Ç–∞ `last` –ø–æ–≤–∏–Ω–Ω—ñ –≤—ñ–¥—Ä—ñ–∑–Ω—è—Ç–∏—Å—è –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –¥–Ω—ñ–≤
- ‚úÖ –Ø–∫—â–æ `rangeInDays` < 1, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –¥–∞–Ω—ñ —Ç—ñ–ª—å–∫–∏ –∑–∞ –∫—ñ–ª—å–∫–∞ –≥–æ–¥–∏–Ω

### –ö—Ä–æ–∫ 2: –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä–Ω—ñ –ª–æ–≥–∏
–£ Vercel Logs –∞–±–æ –ª–æ–∫–∞–ª—å–Ω—ñ–π –∫–æ–Ω—Å–æ–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ:

```
üìä Processed prices: {
  count: 168,
  first: { timestamp: ..., date: "2024-10-07T...", price: ... },
  last: { timestamp: ..., date: "2024-10-14T...", price: ... },
  rangeInDays: "7.00",
  requestedDays: 7
}
```

**–©–æ –ø–µ—Ä–µ–≤—ñ—Ä—è—Ç–∏:**
- ‚úÖ `count` - –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ç–æ—á–æ–∫ –¥–∞–Ω–∏—Ö (–¥–ª—è 7D –º–∞—î –±—É—Ç–∏ ~168 —Ç–æ—á–æ–∫ –ø—Ä–∏ –ø–æ–≥–æ–¥–∏–Ω–Ω–∏—Ö –¥–∞–Ω–∏—Ö)
- ‚úÖ `rangeInDays` –º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ `requestedDays`
- ‚úÖ –Ø–∫—â–æ `rangeInDays` –∑–Ω–∞—á–Ω–æ –º–µ–Ω—à–µ –∑–∞ `requestedDays`, —Ü–µ –æ–∑–Ω–∞—á–∞—î –ø—Ä–æ–±–ª–µ–º—É –∑ CoinGecko API

### –ö—Ä–æ–∫ 3: –í—ñ–∑—É–∞–ª—å–Ω–∞ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –≥—Ä–∞—Ñ—ñ–∫—É
1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ https://pnl-tracker-web-git-develop-dims-projects-53d47b5e.vercel.app/dashboard/markets/ethereum
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —Ä—ñ–∑–Ω—ñ –ø–µ—Ä—ñ–æ–¥–∏:
   - **24H**: –º–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –≥–æ–¥–∏–Ω–∏ (00:00, 06:00, 12:00, —Ç–æ—â–æ)
   - **7D**: –º–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –¥–Ω—ñ –∑ —á–∞—Å–æ–º (Oct 7 12:00, Oct 8 12:00, —Ç–æ—â–æ)
   - **1M**: –º–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –¥–Ω—ñ (Oct 7, Oct 14, Oct 21, —Ç–æ—â–æ)
   - **1Y**: –º–∞—î –ø–æ–∫–∞–∑—É–≤–∞—Ç–∏ –º—ñ—Å—è—Ü—ñ (Oct, Nov, Dec, —Ç–æ—â–æ)

## –ú–æ–∂–ª–∏–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î–∞–Ω—ñ –≤—Å–µ —â–µ –∑–∞ –æ–¥–∏–Ω –¥–µ–Ω—å
**–ü—Ä–∏—á–∏–Ω–∞:** CoinGecko API –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±–º–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ –∞–±–æ —î –ø—Ä–æ–±–ª–µ–º–∞ –∑ rate limiting

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞—è–≤–Ω—ñ—Å—Ç—å –ø–æ–º–∏–ª–æ–∫ 429 (Rate Limit)
2. –Ø–∫—â–æ —î 429, —Å–ø—Ä–æ–±—É–π—Ç–µ:
   - –ó–±—ñ–ª—å—à–∏—Ç–∏ `CACHE_TTL` –≤ `markets-new.ts` (–Ω–∞—Ä–∞–∑—ñ 10 —Ö–≤–∏–ª–∏–Ω)
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ CoinCap fallback (–≤–∂–µ —Ä–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ)

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ö–µ—à –ø–æ–≤–µ—Ä—Ç–∞—î —Å—Ç–∞—Ä—ñ –¥–∞–Ω—ñ
**–ü—Ä–∏—á–∏–Ω–∞:** –ö–µ—à –Ω–µ —ñ–Ω–≤–∞–ª—ñ–¥—É—î—Ç—å—Å—è –ø—Ä–∏ –∑–º—ñ–Ω—ñ –ø–µ—Ä—ñ–æ–¥—É

**–†—ñ—à–µ–Ω–Ω—è:**
1. –û—á–∏—Å—Ç–∏—Ç–∏ –∫–µ—à –±—Ä–∞—É–∑–µ—Ä–∞ (Hard Refresh: Cmd+Shift+R)
2. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ `cacheKey` –≤ –ª–æ–≥–∞—Ö - –≤—ñ–Ω –º–∞—î –≤–∫–ª—é—á–∞—Ç–∏ –ø–µ—Ä—ñ–æ–¥:
   ```
   cacheKey: "ethereum-7"  // –¥–ª—è 7 –¥–Ω—ñ–≤
   cacheKey: "ethereum-30" // –¥–ª—è 30 –¥–Ω—ñ–≤
   ```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ì—Ä–∞—Ñ—ñ–∫ –≤—Å–µ —â–µ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞ –ª—ñ–Ω—ñ—è
**–ü—Ä–∏—á–∏–Ω–∞:** –¶—ñ–Ω–∏ –¥—É–∂–µ –±–ª–∏–∑—å–∫—ñ –æ–¥–Ω–∞ –¥–æ –æ–¥–Ω–æ—ó –∞–±–æ –ø—Ä–æ–±–ª–µ–º–∞ –∑ –º–∞—Å—à—Ç–∞–±—É–≤–∞–Ω–Ω—è–º Y-–æ—Å—ñ

**–†—ñ—à–µ–Ω–Ω—è:**
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –≤ –ª–æ–≥–∞—Ö —Ä—ñ–∑–Ω–∏—Ü—é –º—ñ–∂ `first.price` —Ç–∞ `last.price`
2. –Ø–∫—â–æ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–Ω—ñ–º–∞–ª—å–Ω–∞ (<1%), —Ü–µ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Å—Ç–∞–±—ñ–ª—å–Ω–∏—Ö –º–æ–Ω–µ—Ç
3. –°–ø—Ä–æ–±—É–π—Ç–µ —É–≤—ñ–º–∫–Ω—É—Ç–∏ LOG scale (–∫–Ω–æ–ø–∫–∞ "LOG" –Ω–∞ –≥—Ä–∞—Ñ—ñ–∫—É)

## –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

–Ø–∫—â–æ –ø—Ä–æ–±–ª–µ–º–∞ –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è:
1. –ó–±–µ—Ä—ñ—Ç—å –ª–æ–≥–∏ –∑ –∫–æ–Ω—Å–æ–ª—ñ –±—Ä–∞—É–∑–µ—Ä–∞ —Ç–∞ —Å–µ—Ä–≤–µ—Ä—É
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ, —á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∞—Ü—é—î CoinGecko API:
   ```bash
   curl "https://api.coingecko.com/api/v3/coins/ethereum/market_chart?vs_currency=usd&days=7"
   ```
3. –Ø–∫—â–æ CoinGecko –ø–æ–≤–µ—Ä—Ç–∞—î –æ–±–º–µ–∂–µ–Ω—ñ –¥–∞–Ω—ñ, —Ä–æ–∑–≥–ª—è–Ω—å—Ç–µ:
   - –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è CoinGecko Pro API (–ø–ª–∞—Ç–Ω–∏–π)
   - –ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø—Ä–æ–≤–∞–π–¥–µ—Ä (CoinCap, CryptoCompare)
   - –ö–µ—à—É–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö —É –≤–ª–∞—Å–Ω—ñ–π –ë–î

## –î–µ–ø–ª–æ–π

–ü—ñ—Å–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
git add .
git commit -m "fix: –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –≥—Ä–∞—Ñ—ñ–∫—É —Ü—ñ–Ω –∑ –¥–∏–Ω–∞–º—ñ—á–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è–º –¥–∞—Ç"
git push origin develop
```

Vercel –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–∞–¥–µ–ø–ª–æ—ó—Ç—å –∑–º—ñ–Ω–∏ –Ω–∞ develop branch.
